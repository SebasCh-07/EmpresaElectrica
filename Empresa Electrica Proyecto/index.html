<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma TAT - Gestión de Soporte Técnico</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/tickets.css">
    
    <!-- External Libraries -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="screen active">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <i class="fas fa-tools"></i>
                    <h1>Plataforma TAT</h1>
                    <p>Sistema de Gestión de Soporte Técnico</p>
                </div>
                <form id="loginForm" class="login-form">
                    <div class="form-group">
                        <label for="username">Usuario:</label>
                        <input type="text" id="username" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Contraseña:</label>
                        <input type="password" id="password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Iniciar Sesión</button>
                    <a href="#" id="forgotPassword" class="forgot-password">¿Olvidaste tu contraseña?</a>
                </form>
                <div class="login-info">
                    <p><strong>Usuarios de prueba:</strong></p>
                    <p>admin / 1234 (Administrador)</p>
                    <p>mesa / 1234 (Mesa de Ayuda)</p>
                    <p>tecnico / 1234 (Carlos Pérez - Técnico)</p>
                    <p>tecnico2 / 1234 (Ana Torres - Técnico)</p>
                    <p>tecnico3 / 1234 (Luis García - Técnico)</p>
                    <p>cliente / 1234 (Empresa ABC S.A.)</p>
                    <p>cliente2 / 1234 (Industrias XYZ Ltda.)</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Screen -->
    <div id="mainScreen" class="screen">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <button id="menuToggle" class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1>Plataforma TAT</h1>
            </div>
            <div class="header-right">
                <div class="notifications">
                    <button id="notificationsBtn" class="btn-icon">
                        <i class="fas fa-bell"></i>
                        <span id="notificationCount" class="notification-badge">0</span>
                    </button>
                </div>
                <span id="userInfo" class="user-info"></span>
                <button id="logoutBtn" class="btn btn-secondary">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                </button>
            </div>
        </header>

        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <nav class="nav-menu">
                <ul id="navMenu">
                    <!-- El menú se genera dinámicamente según el rol -->
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard -->
            <div id="dashboard" class="content-section active">
                <div class="section-header">
                    <h2>Dashboard</h2>
                    <div class="header-actions">
                        <button id="refreshDashboard" class="btn btn-secondary">
                            <i class="fas fa-sync-alt"></i> Actualizar
                        </button>
                    </div>
                </div>
                <div id="dashboardContent">
                    <!-- El contenido se genera dinámicamente según el rol -->
                </div>
            </div>

            <!-- Gestión de Tickets -->
            <div id="tickets" class="content-section">
                <div class="section-header">
                    <h2>Gestión de Tickets</h2>
                    <div class="header-actions">
                        <button id="addTicketBtn" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Nuevo Ticket
                        </button>
                        <button id="exportTicketsBtn" class="btn btn-success">
                            <i class="fas fa-file-excel"></i> Exportar
                        </button>
                    </div>
                </div>
                <div class="filters">
                    <select id="estadoFilter">
                        <option value="">Todos los estados</option>
                        <option value="Abierto">Abierto</option>
                        <option value="En Proceso">En Proceso</option>
                        <option value="Pre-cerrado">Pre-cerrado</option>
                        <option value="Cerrado">Cerrado</option>
                    </select>
                    <select id="prioridadFilter">
                        <option value="">Todas las prioridades</option>
                        <option value="Alta">Alta</option>
                        <option value="Media">Media</option>
                        <option value="Baja">Baja</option>
                    </select>
                    <select id="tipoFilter">
                        <option value="">Todos los tipos</option>
                        <option value="Soporte">Soporte</option>
                        <option value="Inspección">Inspección</option>
                        <option value="Responsabilidad">Responsabilidad</option>
                    </select>
                    <button id="filterBtn" class="btn btn-secondary">Filtrar</button>
                    <button id="clearFiltersBtn" class="btn btn-outline">Limpiar</button>
                </div>
                <div class="table-container">
                    <table id="ticketsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Cliente</th>
                                <th>Equipo</th>
                                <th>Tipo</th>
                                <th>Prioridad</th>
                                <th>Estado</th>
                                <th>Técnico</th>
                                <th>Fecha Visita</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="ticketsTableBody">
                            <!-- Se llena dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Detalle de Ticket -->
            <div id="ticketDetail" class="content-section">
                <div class="section-header">
                    <h2>Detalle del Ticket</h2>
                    <div class="header-actions">
                        <button id="backToTickets" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Volver
                        </button>
                        <button id="printTicketBtn" class="btn btn-outline">
                            <i class="fas fa-print"></i> Imprimir
                        </button>
                    </div>
                </div>
                <div id="ticketDetailContent">
                    <!-- Se llena dinámicamente -->
                </div>
            </div>

            <!-- Formulario Técnico -->
            <div id="formularioTecnico" class="content-section">
                <div class="section-header">
                    <h2>Formulario Técnico</h2>
                    <div class="header-actions">
                        <button id="backToTicketsFromForm" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Volver
                        </button>
                        <button id="saveFormBtn" class="btn btn-primary">
                            <i class="fas fa-save"></i> Guardar
                        </button>
                    </div>
                </div>
                <div id="formularioTecnicoContent">
                    <!-- Se llena dinámicamente -->
                </div>
            </div>

            <!-- Gestión de Clientes -->
            <div id="clientes" class="content-section">
                <div class="section-header">
                    <h2>Gestión de Clientes</h2>
                    <div class="header-actions">
                        <button id="addClienteBtn" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Nuevo Cliente
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="clientesTable" class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Cliente</th>
                                <th>Contacto</th>
                                <th>Email</th>
                                <th>Teléfono</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="clientesTableBody">
                            <!-- Se llena dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Gestión de Equipos -->
            <div id="equipos" class="content-section">
                <div class="section-header">
                    <h2>Gestión de Equipos</h2>
                    <div class="header-actions">
                        <button id="addEquipoBtn" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Nuevo Equipo
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="equiposTable" class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Cliente</th>
                                <th>Equipo</th>
                                <th>Modelo</th>
                                <th>Serie</th>
                                <th>Ubicación</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="equiposTableBody">
                            <!-- Se llena dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Gestión de Técnicos -->
            <div id="tecnicos" class="content-section">
                <div class="section-header">
                    <h2>Gestión de Técnicos</h2>
                    <div class="header-actions">
                        <button id="addTecnicoBtn" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Nuevo Técnico
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="tecnicosTable" class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Especialidad</th>
                                <th>Tipo</th>
                                <th>Estado</th>
                                <th>Ubicación</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tecnicosTableBody">
                            <!-- Se llena dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Gestión de Herramientas -->
            <div id="herramientas" class="content-section">
                <div class="section-header">
                    <h2>Gestión de Herramientas</h2>
                    <div class="header-actions">
                        <button id="addHerramientaBtn" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Nueva Herramienta
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="herramientasTable" class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Herramienta</th>
                                <th>Categoría</th>
                                <th>Estado</th>
                                <th>Disponible</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="herramientasTableBody">
                            <!-- Se llena dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Solicitud de Herramientas y Viáticos -->
            <div id="solicitudes" class="content-section">
                <div class="section-header">
                    <h2>Solicitudes de Herramientas y Viáticos</h2>
                    <div class="header-actions">
                        <button id="addSolicitudBtn" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Nueva Solicitud
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="solicitudesTable" class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Ticket</th>
                                <th>Técnico</th>
                                <th>Herramientas</th>
                                <th>Viáticos</th>
                                <th>Estado</th>
                                <th>Fecha</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="solicitudesTableBody">
                            <!-- Se llena dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Gestión de Destinos -->
            <div id="destinos" class="content-section">
                <div class="section-header">
                    <h2>Gestión de Destinos y Tarifas</h2>
                    <div class="header-actions">
                        <button id="addDestinoBtn" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Nuevo Destino
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="destinosTable" class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Destino</th>
                                <th>Provincia</th>
                                <th>Tarifa Base</th>
                                <th>Tarifa por Técnico</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="destinosTableBody">
                            <!-- Se llena dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Geolocalización -->
            <div id="geolocalizacion" class="content-section">
                <div class="section-header">
                    <h2>Ubicación de Técnicos</h2>
                    <div class="header-actions">
                        <button id="refreshLocationBtn" class="btn btn-secondary">
                            <i class="fas fa-sync-alt"></i> Actualizar
                        </button>
                    </div>
                </div>
                <div id="mapContainer" class="map-container">
                    <div id="map" class="map">
                        <div class="map-placeholder">
                            <h3>Mapa de Ubicaciones</h3>
                            <p>Visualizando ubicación de técnicos en tiempo real</p>
                            <div class="tecnicos-map">
                                <!-- Marcadores de técnicos se generan dinámicamente -->
                            </div>
                            <div class="map-legend">
                                <div class="legend-item">
                                    <div class="legend-color disponible"></div>
                                    <span>Disponible</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color en-campo"></div>
                                    <span>En Campo</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color en-oficina"></div>
                                    <span>En Oficina</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Encuesta de Satisfacción -->
            <div id="encuesta" class="content-section">
                <div class="section-header">
                    <h2>Encuesta de Satisfacción</h2>
                    <div class="header-actions">
                        <button id="backToTicketsFromSurvey" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Volver
                        </button>
                    </div>
                </div>
                <div id="encuestaContent">
                    <!-- Se llena dinámicamente -->
                </div>
            </div>

            <!-- Reportes -->
            <div id="reportes" class="content-section">
                <div class="section-header">
                    <h2>Reportes e Informes</h2>
                    <div class="header-actions">
                        <button id="generateReportBtn" class="btn btn-primary">
                            <i class="fas fa-file-pdf"></i> Generar Reporte
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="reportesTable" class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Tipo</th>
                                <th>Cliente</th>
                                <th>Fecha Generación</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="reportesTableBody">
                            <!-- Se llena dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Configuración -->
            <div id="configuracion" class="content-section">
                <div class="section-header">
                    <h2>Configuración del Sistema</h2>
                </div>
                <div class="config-tabs">
                    <button class="tab-btn active" data-tab="usuarios">Usuarios y Roles</button>
                    <button class="tab-btn" data-tab="fases">Fases de Mantenimiento</button>
                    <button class="tab-btn" data-tab="parametros">Parámetros de Encuesta</button>
                    <button class="tab-btn" data-tab="notificaciones">Notificaciones</button>
                </div>
                <div id="configContent">
                    <!-- Se llena dinámicamente -->
                </div>
            </div>
        </main>
    </div>

    <!-- Modales -->
    <div id="modalOverlay" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modalTitle">Título del Modal</h3>
                <button id="closeModal" class="btn-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Contenido del modal -->
            </div>
            <div class="modal-footer" id="modalFooter">
                <!-- Botones del modal -->
            </div>
        </div>
    </div>

    <!-- Notificaciones -->
    <div id="notificationsPanel" class="notifications-panel">
        <div class="notifications-header">
            <h3>Notificaciones</h3>
            <button id="closeNotifications" class="btn-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="notifications-list" id="notificationsList">
            <!-- Se llena dinámicamente -->
        </div>
    </div>

    <!-- JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="js/data.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/core.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/tickets.js"></script>
    <script src="js/data-loaders.js"></script>
</body>
</html>